services:
  - type: web
    name: super-intelligent-line-bot
    env: node
    region: singapore  # é¸æ“‡é›¢å°ç£è¼ƒè¿‘çš„å€åŸŸ
    plan: standard     # å‡ç´šåˆ° standard ä»¥æ”¯æ´æ›´å¤šåŠŸèƒ½å’Œè¨˜æ†¶é«”
    buildCommand: |
      echo "é–‹å§‹å®‰è£ä¾è³´é …ç›®..."
      npm install
      echo "ä¾è³´é …ç›®å®‰è£å®Œæˆ"
    startCommand: |
      echo "ğŸš€ å•Ÿå‹•è¶…ç´šæ™ºèƒ½LINE Bot..."
      npm start
    
    # ç’°å¢ƒè®Šæ•¸é…ç½®
    envVars:
      # Node.js ç’°å¢ƒè¨­å®š
      - key: NODE_ENV
        value: production
      - key: TZ
        value: Asia/Taipei
      - key: PORT
        value: 3000
      
      # LINE Bot API è¨­å®š
      - key: LINE_CHANNEL_ACCESS_TOKEN
        value: G5/Jatw/Mm7gpHjRnVG89Mxp+6QWXINk4mGkga8o3g9TRa96NXiOed5ylkNZjuUtGHXFKCV46xX1t73PZkYdjlqIFoJHe0XiPUP4EyRy/jwJ6sqRtXivrQNA0WH+DK9pLUKg/ybSZ1mvGywuK8upBAdB04t89/1O/w1cDnyilFU=
      - key: LINE_CHANNEL_SECRET
        value: ff89f01585f2b68301b8f8911174cd87
      
      # AI API è¨­å®š - ä¸»è¦ AI å¼•æ“
      - key: GEMINI_API_KEY
        value: AIzaSyBWCitsjkm7DPe_aREubKIZjqmgXafVKNE
      
      # å‚™ç”¨ AI API è¨­å®š - GPT-3.5 å‚™ç”¨å¼•æ“
      - key: BACKUP_AI_KEY
        value: sk-U8sgp8YW0jX3flzFCM1azu85GS6WbHlMyqU7L0ZDer9n8aUM
      - key: BACKUP_AI_URL
        value: https://api.chatanywhere.org/v1
      
      # å¤–éƒ¨ API æœå‹™
      - key: NEWS_API_KEY
        value: 5807e3e70bd2424584afdfc6e932108b
      - key: TMDB_API_KEY
        value: eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyMzI4YmU1YzdhNDA1OTczZDdjMjA0NDlkYmVkOTg4OCIsIm5iZiI6MS43NDYwNzg5MDI5MTgwMDAyZSs5LCJzdWIiOiI2ODEzMGNiNjgyODI5Y2NhNzExZmJkNDkiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.FQlIdfWlf4E0Tw9sYRF7txbWymAby77KnHjTVNFSpdM
      - key: WEATHER_API_KEY
        value: CWA-C80C73F3-7042-4D8D-A88A-D39DD2CFF841
      
      # æœå°‹åŠŸèƒ½é…ç½®
      - key: SEARCH_API_KEY
        value: your-google-search-api-key  # éœ€è¦ç”³è«‹ Google Custom Search API Key
      - key: SEARCH_ENGINE_ID
        value: 526082b509a1942a7  # ä½ çš„ Google Custom Search Engine ID
      
      # é›»è©±é¬§é˜åŠŸèƒ½ï¼ˆTwilioï¼‰
      - key: TWILIO_ACCOUNT_SID
        value: your-twilio-account-sid  # éœ€è¦ç”³è«‹ Twilio å¸³è™Ÿ
      - key: TWILIO_AUTH_TOKEN
        value: your-twilio-auth-token
      - key: TWILIO_PHONE_NUMBER
        value: your-twilio-phone-number
      
      # ç³»çµ±ç®¡ç†å“¡è¨­å®š
      - key: ADMIN_USER_ID
        value: demo326  # ä½ çš„ LINE ID
      - key: OWNER_LINE_ID
        value: demo326  # ä¸»äººçš„ LINE IDï¼ˆç”¨æ–¼æ±ºç­–é€šçŸ¥ï¼‰
      
      # ç³»çµ±æ•ˆèƒ½å„ªåŒ–
      - key: NODE_OPTIONS
        value: "--max-old-space-size=1024 --optimize-for-size"
      - key: UV_THREADPOOL_SIZE
        value: "16"
      
      # åŠŸèƒ½é–‹é—œè¨­å®š
      - key: ENABLE_CONTRADICTION_DETECTION
        value: "true"
      - key: ENABLE_MESSAGE_RECALL_TRACKING
        value: "true"
      - key: ENABLE_PHONE_ALARM
        value: "false"  # é è¨­é—œé–‰ï¼Œéœ€è¦ Twilio è¨­å®šå¾Œé–‹å•Ÿ
      - key: ENABLE_AUTO_LEARNING
        value: "true"
      - key: ENABLE_DECISION_SYSTEM
        value: "true"
      
      # è¨˜æ†¶é«”å’Œå¿«å–è¨­å®š
      - key: MAX_CONVERSATION_HISTORY
        value: "30"     # ç¾¤çµ„å°è©±è¨˜æ†¶æ¢æ•¸
      - key: MAX_PERSONAL_HISTORY
        value: "200"    # å€‹äººå°è©±è¨˜æ†¶æ¢æ•¸
      - key: REMINDER_CHECK_INTERVAL
        value: "10000"  # æé†’æª¢æŸ¥é–“éš”ï¼ˆæ¯«ç§’ï¼‰
      - key: DECISION_TIMEOUT
        value: "1800000" # æ±ºç­–è¶…æ™‚æ™‚é–“ï¼ˆ30åˆ†é˜ï¼‰
      
      # å®‰å…¨æ€§è¨­å®š
      - key: API_RATE_LIMIT
        value: "100"    # API å‘¼å«é »ç‡é™åˆ¶
      - key: MAX_MESSAGE_LENGTH
        value: "2000"   # æœ€å¤§è¨Šæ¯é•·åº¦
    
    # å¥åº·æª¢æŸ¥è¨­å®š
    healthCheckPath: /
    
    # è‡ªå‹•éƒ¨ç½²è¨­å®š
    autoDeploy: true
    
    # å»ºç½®è¨­å®š
    buildFilter:
      paths:
        - app.js
        - package.json
        - package-lock.json
      ignoredPaths:
        - README.md
        - .gitignore
        - docs/**
    
    # è³‡æºé…ç½®
    disk:
      name: bot-storage
      size: 2GB
      mountPath: /tmp/bot-data
    
    # é æ‹‰å–è¨­å®šï¼ˆåŠ é€Ÿå•Ÿå‹•ï¼‰
    preDeployCommand: |
      echo "ğŸ”§ é éƒ¨ç½²è¨­å®š..."
      echo "æª¢æŸ¥ Node.js ç‰ˆæœ¬: $(node --version)"
      echo "æª¢æŸ¥ NPM ç‰ˆæœ¬: $(npm --version)"
      echo "æ¸…ç†å¿«å–..."
      npm cache clean --force
    
    # éƒ¨ç½²å¾ŒæŒ‡ä»¤
    postDeployCommand: |
      echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
      echo "ğŸ“± LINE Bot æœå‹™å·²å•Ÿå‹•"
      echo "ğŸ¤– AI å€‹æ€§ç³»çµ±å·²è¼‰å…¥"
      echo "â° æé†’ç³»çµ±å·²æ¿€æ´»"
      echo "âš–ï¸ æ±ºç­–ç³»çµ±å·²å°±ç·’"
      echo "ğŸ” æœå°‹åŠŸèƒ½å·²é€£æ¥"
      echo "ğŸ“Š ç³»çµ±ç›£æ§å·²é–‹å•Ÿ"

# å¯é¸ï¼šè³‡æ–™åº«æœå‹™ï¼ˆå¦‚æœéœ€è¦æŒä¹…åŒ–å­˜å„²ï¼‰
# databases:
#   - name: bot-database
#     databaseName: line_bot_db
#     user: bot_user
#     region: singapore

# å¯é¸ï¼šRedis å¿«å–æœå‹™
# services:
#   - type: redis
#     name: bot-cache
#     region: singapore
#     plan: starter